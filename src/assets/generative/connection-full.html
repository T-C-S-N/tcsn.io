<!DOCTYPE html>
<html lang="en">

<head>
   <meta charset="UTF-8">
   <meta
      http-equiv="X-UA-Compatible"
      content="IE=edge"
   >
   <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0"
   >
   <title>Connection full</title>

   <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.5.0/p5.min.js"></script>
</head>

<body>

   <style>
      html,
      body {
         margin: 0;
         padding: 0;
         display: flex;
         justify-content: center;
         align-items: center;
         width: 100vw;
         height: 100vh;
      }
   </style>

   <script>
      const canvasSize = 300;
      const canvasWidth = 2000
      const canvasHeight = 1000;
      const margin = 0;
      const objectAmount = 15;
      const connectionRadiusPercentage = 15;
      const o = [];

      function createObjects () {
         for (let i = 0; i < objectAmount; i++) {
            o.push({
               x: random(margin, canvasWidth - margin),
               y: random(margin, canvasHeight - margin),
               rx: 10,
               dx: Math.floor(random(2)),
               dy: Math.floor(random(2)),
               r: random(0, 255),
               g: random(0, 255),
               b: random(0, 255),
               s: random(0.5, 3),
            });
         }
      }

      function collision (p1x, p1y, r1, p2x, p2y, r2) {
         var a;
         var x;
         var y;

         a = r1 + r2;
         x = p1x - p2x;
         y = p1y - p2y;

         return a > Math.sqrt(x * x + y * y);
      }

      function setup () {
         createCanvas(canvasWidth, canvasHeight);
         frameRate(60);
         createObjects();
      }

      function draw () {
         background(255);
         noStroke();

         for (let i = 0; i < o.length; i++) {
            let d = canvasWidth / connectionRadiusPercentage;
            o.map((p) => {
               // connection line
               if (i < o.length - 1 && collision(o[i].x, o[i].y, d, p.x, p.y, d)) {
                  push();
                  stroke(0, 0, 0, 30);
                  line(o[i].x, o[i].y, p.x, p.y);
                  pop();
               }

               // ellipse(o[i].x, o[i].y, d, d);
               // p.dx = !p.dx;
               // p.dy = !p.dy;
            });
         }

         for (let p of o) {
            if (p.x > canvasWidth - margin || p.x < margin) {
               p.dx = !p.dx;
               //p.y += random(2);
            }
            if (p.y > canvasHeight - margin || p.y < margin) {
               p.dy = !p.dy;
               //p.x += random(2);
            }
            //if (p.x > canvasSize - margin) p.x = margin;
            //if (p.x < margin) p.x = canvasSize - margin;

            p.x = p.dx ? p.x + p.s : p.x - p.s;
            p.y = p.dy ? p.y + p.s : p.y - p.s;

            push();
            fill(255);
            fill(0, 0, 0, 500);
            ellipse(p.x, p.y, p.rx / 2, p.rx / 2);
            pop();
         }
      }
   </script>

</body>

</html>